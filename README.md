# ChronobioticsDB Meta-Prompting Agent

This repository contains code and data for an article from the journal:
Biomedical Chemistry: Research and Methods
http://www.bmc-rm.org/index.php/BMCRM, 2026.

The system demonstrates a two-stage AI agent that answers natural language questions about chronobiotic substances using only information from the ChronobioticsDB knowledge base, with strict control over output format, language, and factual accuracy.

## Overview

The agent uses a meta-prompting + post-processing architecture:

1. Meta-prompting stage:
The model (DeepSeek-R1-0528-Qwen3-8B) generates its own optimal system prompts based on example cards, adhering to strict rules:

- Output in English only
- No reasoning traces (<think> tags)

- Answers only from provided cards

- Explicitly specify source cards

- Clearly handle missing data

2. Execution stage:
The generated prompt is used to answer the user's questions, followed by robust post-processing that:

- Removes any residual reasoning

- Ensures the correct answer format

- Checks language and structure

3. Evaluation:
Tested on 12 different questions (mechanisms, effects, FDA status, etc.) using comprehensive quality metrics.

## Files

File and Description
test111.py - Main execution script (meta-prompts + executor + score)
test23.py - Script for generating a text index from structured CSV files
chronobiotic_index_full.txt - Full ChronobioticsDB knowledge base in text format (345 cards)
chronobiotics_final_results.txt - Full test results log (12 questions)
meta_generated_prompt.txt - System prompt generated by DeepSeek-R1
final_stats.json - Aggregated performance metrics

## Requirements

- Python 3.9+ - PyTorch
- Transformers (Hugging Face)
- CUDA-compatible GPU (for full model inference)

Installing dependencies:
Bash

pip install torch transformers accelerate

## How to Run

1. Place all files in one directory. 

2. Ensure you have access to the "deepseek-ai/DeepSeek-R1-0528-Qwen3-8B" model.

3. Run:
Bash

python test111.py

4. The results will be saved to the files chronobiotics_final_results.txt and final_stats.json.

Warning: This model requires a significant amount of GPU memory (~20+ GB). A fallback mode is provided to handle out-of-memory (OOM) errors.

## Data source

This work is based on the ChronobioticsDB knowledge base, a manually curated collection of chronobiotic substances first described in:

https://www.mdpi.com/2624-5175/7/3/30

This work builds directly on this knowledge base, enabling natural language queries with guaranteed contextualization.

## Key results (from final_stats.json)

- 12 out of 12 questions processed successfully
- 100% of responses in English only
- 100% no reasoning traces (free of chain-of-thought or internal analysis)
- 100% correct output format
- 3 out of 12 responses clearly indicate data limitations

Note: This version does not fully implement card reference detection in post-processing (hence has_refs: 0), but manual verification confirms correct citations in most cases.

## License

- Code: MIT license
- Data (chronobiotic_index_full.txt): Provided with permission for academic reproducibility;

